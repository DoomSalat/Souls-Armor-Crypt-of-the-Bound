# Skeleton Group Attack System

Система поочерёдной атаки скелетов в группе. Предоставляет три различных подхода к реализации.

## Обзор

Скелеты в группе атакуют поочерёдно: лидер атакует первым, затем каждый следующий скелет в цепочке. Самостоятельная атака отключена для всех членов группы.

## Варианты реализации

### 1. SkeletonGroupController (Рекомендуемый)

**Файл:** `SkeletonGroupController.cs`

**Описание:** Специальный контроллер группы, наследуется от `BaseGroupController` и переопределяет логику атаки.

**Особенности:**
- Интегрирован в существующую систему групп
- Использует очередь (Queue) для случайного порядка атак
- Каждый скелет уведомляет о завершении атаки
- Настраиваемые параметры задержки и дистанции
- Отладочная информация в инспекторе

**Использование:**
1. Добавить компонент `SkeletonGroupController` на скелета-лидера
2. Настроить параметры в инспекторе
3. Система автоматически инициализируется при создании группы

### 2. SkeletonGroupAttackManager

**Файл:** `SkeletonGroupAttackManager.cs`

**Описание:** Отдельный менеджер атак, независимый от других систем.

**Особенности:**
- Полная независимость от других компонентов
- События для интеграции с UI/звуком
- Гибкая настройка поведения
- Автоматический запуск цепочки

**Использование:**
1. Добавить компонент на любой GameObject
2. Зарегистрировать группу через `RegisterSkeletonGroup()`
3. Подписаться на события для дополнительной логики

## Автоматическое определение группы

Скелет автоматически определяет, является ли он частью группы, проверяя наличие компонента `IGroupController` в `Awake()`:

```csharp
if (TryGetComponent<IGroupController>(out var groupController))
{
    _isGroupControlled = true;
}
```

Это позволяет избежать ручного управления флагами группового контроля.

## Настройка параметров

### Общие параметры для всех вариантов:
- `_attackDelay` - Задержка между атаками скелетов (0.5f по умолчанию)
- `_maxAttackDistance` - Максимальная дистанция для атаки (8f по умолчанию)
- `_minAttackDistance` - Минимальная дистанция для атаки (3f по умолчанию)

### SkeletonGroupController дополнительные параметры:
- `_attackChainDelay` - Задержка в цепочке атак
- Отладочная информация в инспекторе

## Логика работы

1. **Инициализация:** Скелеты регистрируются в группе и подписываются на события завершения атаки
2. **Проверка условий:** Проверяется дистанция до цели и готовность к атаке
3. **Создание очереди:** Создаётся случайная очередь атак из всех готовых скелетов
4. **Запуск цепочки:** Первый скелет из очереди начинает атаку
5. **Уведомление о завершении:** Каждый скелет уведомляет о завершении атаки
6. **Следующая атака:** Через заданную задержку атакует следующий скелет из очереди
7. **Завершение:** Цепочка завершается когда очередь пуста

## Отладка

Все варианты включают отладочные методы:
- `DebugStartAttackChain()` - Запуск цепочки атак
- `DebugEndAttackChain()` - Остановка цепочки атак
- `DebugCheckTargetRange()` - Проверка дистанции до цели

## Рекомендации

**Для новых проектов:** Используйте `SkeletonGroupController` - он наиболее интегрирован в архитектуру и использует современную систему очередей.

**Для существующих проектов:** 
- Если уже используется система групп - `SkeletonGroupController`
- Если нужно быстро добавить функциональность - `SkeletonGroupAttackManager`
